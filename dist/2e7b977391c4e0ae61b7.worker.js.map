{"version":3,"sources":["webpack:///webpack/bootstrap 2e7b977391c4e0ae61b7","webpack:///./src/worker/Worker.js","webpack:///./src/util/index.js","webpack:///./src/util/SearchUtility.js","webpack:///./src/util/SearchIndex.js"],"names":[],"mappings":"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","file":"2e7b977391c4e0ae61b7.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2e7b977391c4e0ae61b7\n **/","import SearchUtility from '../util'\n\n/**\n * Search entry point to web worker.\n * Builds search index and performs searches on separate thread from the ui.\n */\n\nconst searchUtility = new SearchUtility()\n\nself.addEventListener('message', event => {\n  const { data } = event\n  const { method } = data\n\n  switch (method) {\n    case 'indexDocument':\n      const { uid, text } = data\n\n      searchUtility.indexDocument(uid, text)\n      break\n    case 'removeDocument':\n      const { rUid } = data\n\n      searchUtility.removeDocument(rUid)\n      break\n    case 'search':\n      const { callbackId, query } = data\n\n      const results = searchUtility.search(query)\n\n      self.postMessage({ callbackId, results })\n      break\n  }\n}, false)\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/worker/Worker.js\n **/","export default from './SearchUtility'\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/index.js\n **/","import SearchIndex from './SearchIndex'\n\n/**\n * Synchronous client-side full-text search utility.\n * Forked from JS search (github.com/bvaughn/js-search).\n */\nexport default class SearchUtility {\n\n  /**\n   * Constructor.\n   */\n  constructor () {\n    this.searchIndex = new SearchIndex()\n    this.uids = {}\n  }\n\n  /**\n   * Adds or updates a uid in the search index and associates it with the specified text.\n   * Note that at this time uids can only be added or updated in the index, not removed.\n   *\n   * @param uid Uniquely identifies a searchable object\n   * @param text Text to associate with uid\n   */\n  indexDocument (uid: any, text: string): SearchUtility {\n    this.uids[uid] = true\n\n    var fieldTokens: Array<string> = this._tokenize(this._sanitize(text))\n\n    fieldTokens.forEach(fieldToken => {\n      var expandedTokens: Array<string> = this._expandToken(fieldToken)\n\n      expandedTokens.forEach(expandedToken =>\n        this.searchIndex.indexDocument(expandedToken, uid)\n      )\n    })\n\n    return this\n  }\n\n  removeDocument (uid: any): SearchUtility {\n    this.uids[uid] = true\n\n    if (this.uids[uid]) {\n      this.searchIndex.removeDocument(uid)\n      this.uids[uid] = null\n    }\n\n    return this\n  }\n\n  /**\n   * Searches the current index for the specified query text.\n   * Only uids matching all of the words within the text will be accepted.\n   * If an empty query string is provided all indexed uids will be returned.\n   *\n   * Document searches are case-insensitive (e.g. \"search\" will match \"Search\").\n   * Document searches use substring matching (e.g. \"na\" and \"me\" will both match \"name\").\n   *\n   * @param query Searchable query text\n   * @return Array of uids\n   */\n  search (query: string): Array<any> {\n    if (!query) {\n      return Object.keys(this.uids)\n    } else {\n      var tokens: Array<string> = this._tokenize(this._sanitize(query))\n\n      return this.searchIndex.search(tokens)\n    }\n  }\n\n  /**\n   * Index strategy based on 'all-substrings-index-strategy.ts' in github.com/bvaughn/js-search/\n   *\n   * @private\n   */\n  _expandToken (token: string): Array<string> {\n    var expandedTokens = []\n\n    // String.prototype.charAt() may return surrogate halves instead of whole characters.\n    // When this happens in the context of a web-worker it can cause Chrome to crash.\n    // Catching the error is a simple solution for now; in the future I may try to better support non-BMP characters.\n    // Resources:\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charAt\n    // https://mathiasbynens.be/notes/javascript-unicode\n    try {\n      for (let i = 0, length = token.length; i < length; ++i) {\n        let prefixString: string = ''\n\n        for (let j = i; j < length; ++j) {\n          prefixString += token.charAt(j)\n          expandedTokens.push(prefixString)\n        }\n      }\n    } catch (error) {\n      console.error(`Unable to parse token \"${token}\" ${error}`)\n    }\n\n    return expandedTokens\n  }\n\n  /**\n   * @private\n   */\n  _sanitize (string: string): string {\n    return string.trim().toLocaleLowerCase()\n  }\n\n  /**\n   * @private\n   */\n  _tokenize (text: string): Array<string> {\n    return text\n      .split(/\\s+/)\n      .filter(text => text) // Remove empty tokens\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/SearchUtility.js\n **/","/**\n * Maps search tokens to uids.\n * This structure is used by the Search class to optimize search operations.\n * Forked from JS search (github.com/bvaughn/js-search).\n */\nexport default class SearchIndex {\n  tokenToUidMap: { [token: string]: any }\n\n  constructor () {\n    this.tokenToUidMap = {}\n    this.UiToTokenMap = {}\n  }\n\n  /**\n   * Maps the specified token to a uid.\n   *\n   * @param token Searchable token (e.g. \"road\")\n   * @param uid Identifies a document within the searchable corpus\n   */\n  indexDocument (token: string, uid: any): void {\n    if (!this.tokenToUidMap[token]) {\n      this.tokenToUidMap[token] = {}\n      this.tokenToUidMap[token][uid] = uid\n    }\n\n    if (!this.UiToTokenMap[uid]) {\n      this.UiToTokenMap[uid] = {}\n      this.UiToTokenMap[uid][token] = uid\n    }\n  }\n\n  removeDocument (uid: any): void {\n    let currentUidTokens: {[uid: any]: any} = this.UiToTokenMap[uid]\n\n    if (currentUidTokens) {\n      for (let token in currentUidTokens) {\n        delete this.tokenToUidMap[token][uid]\n      }\n      delete this.UiToTokenMap[uid]\n    }\n  }\n\n  /**\n   * Finds uids that have been mapped to the set of tokens specified.\n   * Only uids that have been mapped to all tokens will be returned.\n   *\n   * @param tokens Array of searchable tokens (e.g. [\"long\", \"road\"])\n   * @return Array of uids that have been associated with the set of search tokens\n   */\n  search (tokens: Array<string>): Array<any> {\n    let uidMap: {[uid: any]: any} = {}\n    let initialized = false\n\n    tokens.forEach(token => {\n      let currentUidMap: {[uid: any]: any} = this.tokenToUidMap[token] || {}\n\n      if (!initialized) {\n        initialized = true\n\n        for (let uid in currentUidMap) {\n          uidMap[uid] = currentUidMap[uid]\n        }\n      } else {\n        for (let uid in uidMap) {\n          if (!currentUidMap[uid]) {\n            delete uidMap[uid]\n          }\n        }\n      }\n    })\n\n    let uids: Array<any> = []\n\n    for (let uid in uidMap) {\n      uids.push(uidMap[uid])\n    }\n\n    return uids\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/SearchIndex.js\n **/"],"sourceRoot":""}